<!DOCTYPE html>


  <html class="light page-post">


<head>
  <meta charset="utf-8">
  
  <title>Windows sysinternals tools | Code4Fun</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="windows," />
  

  <meta name="description" content="微软在官网上提供了一系列的具有多种用途的小工具, 这里就罗列介绍一部分有用或者有意思的小工具, 详细内容可以参考官方主页. 分类也基本参照官网, 但是只选取了其中有意思的部分.
文件与硬盘相关disk usage一个十分简单的命令行工具,给定路径可以迭代输出路径下所有文件夹的大小. 也可以不迭代或者是给定迭代层数.
contig为了优化性能, 我们会对硬盘做一些去碎片化的工作. 而conitg这个">
<meta property="og:type" content="article">
<meta property="og:title" content="Windows sysinternals tools">
<meta property="og:url" content="http://code4fun.me/2019/12/25/sysinternals/index.html">
<meta property="og:site_name" content="Code4Fun">
<meta property="og:description" content="微软在官网上提供了一系列的具有多种用途的小工具, 这里就罗列介绍一部分有用或者有意思的小工具, 详细内容可以参考官方主页. 分类也基本参照官网, 但是只选取了其中有意思的部分.
文件与硬盘相关disk usage一个十分简单的命令行工具,给定路径可以迭代输出路径下所有文件夹的大小. 也可以不迭代或者是给定迭代层数.
contig为了优化性能, 我们会对硬盘做一些去碎片化的工作. 而conitg这个">
<meta property="og:image" content="https://raw.githubusercontent.com/zhangzhishan/blogpics/dev/1577343723_20191225165345511_27540.png">
<meta property="og:image" content="https://raw.githubusercontent.com/zhangzhishan/blogpics/dev/1577343717_20191225163408852_17579.png">
<meta property="og:image" content="https://raw.githubusercontent.com/zhangzhishan/blogpics/dev/1577343726_20191225170315138_31452.png">
<meta property="og:image" content="https://raw.githubusercontent.com/zhangzhishan/blogpics/dev/1577343728_20191226150020705_11738.png">
<meta property="og:image" content="https://raw.githubusercontent.com/zhangzhishan/blogpics/dev/1577343724_20191225170051070_7770.png">
<meta property="og:image" content="https://raw.githubusercontent.com/zhangzhishan/blogpics/dev/1577343727_20191225174041767_2182.png">
<meta property="og:image" content="https://raw.githubusercontent.com/zhangzhishan/blogpics/dev/1577343720_20191225164242847_4264.png">
<meta property="og:updated_time" content="2025-06-13T10:54:27.290Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Windows sysinternals tools">
<meta name="twitter:description" content="微软在官网上提供了一系列的具有多种用途的小工具, 这里就罗列介绍一部分有用或者有意思的小工具, 详细内容可以参考官方主页. 分类也基本参照官网, 但是只选取了其中有意思的部分.
文件与硬盘相关disk usage一个十分简单的命令行工具,给定路径可以迭代输出路径下所有文件夹的大小. 也可以不迭代或者是给定迭代层数.
contig为了优化性能, 我们会对硬盘做一些去碎片化的工作. 而conitg这个">
<meta name="twitter:image" content="https://raw.githubusercontent.com/zhangzhishan/blogpics/dev/1577343723_20191225165345511_27540.png">

  

  
    <link rel="icon" href="/favicon.ico">
  

  <link href="/css/styles.css?v=c114cbeddx" rel="stylesheet">


  
    <link rel="stylesheet" href="/css/personal-style.css">
  

  

  

  


  
    <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

<link rel="alternate" href="/atom.xml" title="Code4Fun" type="application/atom+xml">
</head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">盒子</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">盒子</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/archives/"
            rel="noopener noreferrer"
            target="_self"
            >
            博客
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/category/"
            rel="noopener noreferrer"
            target="_self"
            >
            分类
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/tag/"
            rel="noopener noreferrer"
            target="_self"
            >
            标签
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/link/"
            rel="noopener noreferrer"
            target="_self"
            >
            友链
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            rel="noopener noreferrer"
            target="_self"
            >
            关于
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/atom.xml"
            rel="noopener noreferrer"
            target="_blank"
            >
            RSS
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/search/"
            rel="noopener noreferrer"
            target="_self"
            >
            搜索
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#文件与硬盘相关"><span class="toc-text">文件与硬盘相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#disk-usage"><span class="toc-text">disk usage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#contig"><span class="toc-text">contig</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pendmove"><span class="toc-text">pendmove</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#网络相关"><span class="toc-text">网络相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#whois"><span class="toc-text">whois</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pipelist"><span class="toc-text">pipelist</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#进程相关"><span class="toc-text">进程相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#vmmap"><span class="toc-text">vmmap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pstools"><span class="toc-text">pstools</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#process-explorer"><span class="toc-text">process explorer</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安全相关"><span class="toc-text">安全相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sysmon"><span class="toc-text">sysmon</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#系统信息"><span class="toc-text">系统信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rammap"><span class="toc-text">rammap</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#杂"><span class="toc-text">杂</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#testlimit"><span class="toc-text">testlimit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BlueScreen-Screen-Saver"><span class="toc-text">BlueScreen Screen Saver</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zoom-it"><span class="toc-text">zoom it</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hex2dec"><span class="toc-text">hex2dec</span></a></li></ol></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-sysinternals" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">Windows sysinternals tools</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2019.12.25</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>呼呼呼山</span>
        </span>
      

      


      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbsp热度 <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>℃
        </span>
      
      
    </div>
  </header>

  <div class="article-content">
    
      <p>微软在官网上提供了一系列的具有多种用途的小工具, 这里就罗列介绍一部分有用或者有意思的小工具, 详细内容可以参考<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/" target="_blank" rel="external">官方主页</a>. 分类也基本参照官网, 但是只选取了其中有意思的部分.</p>
<h2 id="文件与硬盘相关"><a href="#文件与硬盘相关" class="headerlink" title="文件与硬盘相关"></a>文件与硬盘相关</h2><h3 id="disk-usage"><a href="#disk-usage" class="headerlink" title="disk usage"></a><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/du" target="_blank" rel="external">disk usage</a></h3><p>一个十分简单的命令行工具,给定路径可以迭代输出路径下所有文件夹的大小. 也可以不迭代或者是给定迭代层数.<br><img src="https://raw.githubusercontent.com/zhangzhishan/blogpics/dev/1577343723_20191225165345511_27540.png" alt="du"></p>
<h3 id="contig"><a href="#contig" class="headerlink" title="contig"></a><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/contig" target="_blank" rel="external">contig</a></h3><p>为了优化性能, 我们会对硬盘做一些去碎片化的工作. 而conitg这个工具则主要是针对单个文件的.</p>
<p>Contig is a single-file defragmenter that attempts to make files contiguous on disk. Its perfect for quickly optimizing files that are continuously becoming fragmented, or that you want to ensure are in as few fragments as possible.</p>
<h3 id="pendmove"><a href="#pendmove" class="headerlink" title="pendmove"></a><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/pendmoves" target="_blank" rel="external">pendmove</a></h3><p>用了 <code>movefile</code> 命令可以使得这次操作会在下次启动的时候生效, 而<code>pendmoves</code>则可以输出所有待move的文件.</p>
<h2 id="网络相关"><a href="#网络相关" class="headerlink" title="网络相关"></a>网络相关</h2><h3 id="whois"><a href="#whois" class="headerlink" title="whois"></a><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/whois" target="_blank" rel="external">whois</a></h3><p>get whois information from whois.markmonitor.com, for example, use <code>whois64.exe bing.com</code> can get information below.<br><img src="https://raw.githubusercontent.com/zhangzhishan/blogpics/dev/1577343717_20191225163408852_17579.png" alt="whois"></p>
<h3 id="pipelist"><a href="#pipelist" class="headerlink" title="pipelist"></a><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/pipelist" target="_blank" rel="external">pipelist</a></h3><p>列出所有的 named pipes.</p>
<h2 id="进程相关"><a href="#进程相关" class="headerlink" title="进程相关"></a>进程相关</h2><h3 id="vmmap"><a href="#vmmap" class="headerlink" title="vmmap"></a><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/vmmap" target="_blank" rel="external">vmmap</a></h3><p>分析给定的进程的虚拟和物理内存, 可以看到每一类虚拟内存和实际物理内存的大小.<br><img src="https://raw.githubusercontent.com/zhangzhishan/blogpics/dev/1577343726_20191225170315138_31452.png" alt="vmmap"></p>
<h3 id="pstools"><a href="#pstools" class="headerlink" title="pstools"></a><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/pstools" target="_blank" rel="external">pstools</a></h3><p>pstools 是一个集合, 里面包含各种工具, 主要是这些工具可以方便的在远程机器上执行, 只需要给定机器名和登录所需的用户名密码. 一些参见下面: </p>
<ul>
<li><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psexec" target="_blank" rel="external">psexec</a> - execute processes remotely</li>
<li><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psfile" target="_blank" rel="external">psfile</a> - shows files opened remotely</li>
<li>psgetsid - display the sid of a computer or a user</li>
<li>psinfo - list information about a system</li>
<li>psping - measure network performance</li>
<li><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/pskill" target="_blank" rel="external">pskill</a> - kill processes by name or process id</li>
<li><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/pslist" target="_blank" rel="external">pslist</a> - list detailed information about processes</li>
<li>psloggedon - see who’s logged on locally and via resource sharing (full source is included)</li>
<li>psloglist - dump event log records</li>
<li>pspasswd - changes account passwords</li>
<li>psservice - view and control services</li>
<li>psshutdown - shuts down and optionally reboots a computer</li>
<li>PsSuspend - suspends processes<h3 id="process-explorer"><a href="#process-explorer" class="headerlink" title="process explorer"></a><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer" target="_blank" rel="external">process explorer</a></h3>一个很强大的进程管理器, 可以把进程以树的形式展示出来.<br><img src="https://raw.githubusercontent.com/zhangzhishan/blogpics/dev/1577343728_20191226150020705_11738.png" alt="process explorer"><h2 id="安全相关"><a href="#安全相关" class="headerlink" title="安全相关"></a>安全相关</h2><h3 id="sysmon"><a href="#sysmon" class="headerlink" title="sysmon"></a><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon" target="_blank" rel="external">sysmon</a></h3>System Monitor (Sysmon) 是一个windows service. 安装后会输出详细的进程创建, 网络连接等信息.<h2 id="系统信息"><a href="#系统信息" class="headerlink" title="系统信息"></a>系统信息</h2><h3 id="rammap"><a href="#rammap" class="headerlink" title="rammap"></a><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/rammap" target="_blank" rel="external">rammap</a></h3>可以利用此工具看到详细的不同内存的统计信息, 每个文件映射到内存中的size,乃至每一个物理内存对应哪些实际文件, 或者某文件在物理内存中的索引.<br><img src="https://raw.githubusercontent.com/zhangzhishan/blogpics/dev/1577343724_20191225170051070_7770.png" alt="rammap"><h2 id="杂"><a href="#杂" class="headerlink" title="杂"></a>杂</h2><h3 id="testlimit"><a href="#testlimit" class="headerlink" title="testlimit"></a><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/testlimit" target="_blank" rel="external">testlimit</a></h3>一个可以用来占据内存,handles, processes, threads等的工具. 需要搭配psexec使用, 例如: <code>.\PsExec.exe -sid Testlimit64.exe -r  1000 -c 1</code><br><img src="https://raw.githubusercontent.com/zhangzhishan/blogpics/dev/1577343727_20191225174041767_2182.png" alt="testlimit"></li>
</ul>
<p>reserve 1000 MB memory, reverse次数为1.</p>
<h3 id="BlueScreen-Screen-Saver"><a href="#BlueScreen-Screen-Saver" class="headerlink" title="BlueScreen Screen Saver"></a><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/bluescreen" target="_blank" rel="external">BlueScreen Screen Saver</a></h3><p>传统windows崩溃页面作为屏保.</p>
<h3 id="zoom-it"><a href="#zoom-it" class="headerlink" title="zoom it"></a><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/zoomit" target="_blank" rel="external">zoom it</a></h3><p>利用快捷键放大屏幕, 然后也可以做一些标注.</p>
<h3 id="hex2dec"><a href="#hex2dec" class="headerlink" title="hex2dec"></a><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/hex2dec" target="_blank" rel="external">hex2dec</a></h3><p>十分方便的十进制与16进制转换,参看截图.</p>
<p><img src="https://raw.githubusercontent.com/zhangzhishan/blogpics/dev/1577343720_20191225164242847_4264.png" alt="hex2dec"></p>
<blockquote>
<p><a href="http://code4fun.me">呼呼呼山</a><br>2019-12-25 09:58:00</p>
</blockquote>

    
  </div>

</article>


   

   
  <div class="box-prev-next clearfix">
    <a class="show pull-left" href="/2019/07/15/in memory index/">
        <i class="icon icon-angle-left"></i>
    </a>
    <a class="show pull-right" href="/2020/04/10/windbg for memory leak/">
        <i class="icon icon-angle-right"></i>
    </a>
  </div>




</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">关闭</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/archives/"
              rel="noopener noreferrer"
              target="_self"
              >
              博客
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/category/"
              rel="noopener noreferrer"
              target="_self"
              >
              分类
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/tag/"
              rel="noopener noreferrer"
              target="_self"
              >
              标签
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/link/"
              rel="noopener noreferrer"
              target="_self"
              >
              友链
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              rel="noopener noreferrer"
              target="_self"
              >
              关于
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/atom.xml"
              rel="noopener noreferrer"
              target="_blank"
              >
              RSS
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/search/"
              rel="noopener noreferrer"
              target="_self"
              >
              搜索
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    

    

    
    

    

    
    

    

<!-- Gitalk评论插件通用代码 -->
<div id="gitalk-container"></div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js"></script>
<script>
const gitalk = new Gitalk({
  clientID: '99bca29ad4d85951d688',
  clientSecret: 'd956164d57277ed8ece2fab34d91f67506dd50d6',
  repo: 'blog-comment',
  owner: 'zhangzhishan',
  // 在这里设置一下截取前50个字符串, 这是因为 github 对 label 的长度有了要求, 如果超过
  // 50个字符串则会报错.
  // id: location.pathname.split('/').pop().substring(0, 49),
  id: md5(location.pathname),
  admin: ['zhangzhishan'],
  // facebook-like distraction free mode
  distractionFreeMode: false
})
gitalk.render('gitalk-container')
</script>
<!-- Gitalk代码结束 -->



  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
